{#ptfable#}
{% load i18n %}
{% load extras %}
{% load pagination_tags %}

<div class="sp">
{% load cache %}
{% if subtopic %}
  <p>{% trans "You are viewing part of the topic" %}</p>
{% else %}
{% with top_post as post %}
<div class="tp">
  <div id="p{{ post.id_form_m }}">
    {% include "snapboard/include/post_full_header.html" %}
    {% include "snapboard/include/post_full_body.html" %}
  </div>
</div>
{% endwith %}
{% endif %}

{# autopaginate post_list user_settings.ppp #}
<div class="ba">{% paginate %}

{% if top_post.nav %} {# experimental navigation #}
<span class="n">
{% if top_post.n_left %}
  <a href="{% url snapboard_post top_post.n_left.id_form_m %}
    {% if request.GET %}?{{ request.GET.urlencode }}{% endif %}">
    ←</a>
{% else %}←{% endif %}
{% if top_post.n_down %}
  <a href="{% url snapboard_post top_post.n_down.id_form_m %}
    {% if request.GET %}?{{ request.GET.urlencode }}{% endif %}">
    ↓</a>
{% else %}↓{% endif %}
{% if top_post.n_up %}
  <a href="{% url snapboard_post top_post.n_up.id_form_m %}
    {% if request.GET %}?{{ request.GET.urlencode }}{% endif %}">
    ↑</a>
{% else %}↑{% endif %}
{% if top_post.n_right %}
  <a href="{% url snapboard_post top_post.n_right.id_form_m %}
    {% if request.GET %}?{{ request.GET.urlencode }}{% endif %}">
  →</a>
{% else %}→{% endif %}
</span>
{% endif %}
</div>
<div class="w{% if subtopic %} st{% endif %}">
{% for post, post_info in post_list %}
  {% if not post_info.open %}</div></div>{% endif %}
  <div id="p{{ post.id_form_m }}"{% if not post.is_flat %}{% ifnotequal post.depth listdepth %}{% if post.next_sibling %} class="nf np{% if post.numchild != 1 %} l{% endif %}{% if post.censor %}{% if not user.is_staff %} pc{% else %} apc{% endif %}{% else %}{% ifnotequal post.abuse 0 %}{% if not user.is_staff %} pr{% else %} apr{% endif %}{% endifnotequal %}{% endif %}"{% else %} class="nf ep{% if post.numchild != 1 %} l{% endif %}{% if post.censor %}{% if not user.is_staff %} pc{% else %} apc{% endif %}{% else %}{% ifnotequal post.abuse 0 %}{% if not user.is_staff %} pr{% else %} apr{% endif %}{% endifnotequal %}{% endif %}"{% endif %}{% else %}{% if post.numchild != 1 %} class="l{% if post.censor %}{% if not user.is_staff %} pc{% else %} apc{% endif %}{% else %}{% ifnotequal post.abuse 0 %}{% if not user.is_staff %} pr{% else %} apr{% endif %}{% endifnotequal %}{% endif %}"{% else %}{% if post.censor %}{% if not user.is_staff %} class="pc"{% else %} class="apc"{% endif %}{% else %}{% ifnotequal post.abuse 0 %}{% if not user.is_staff %}class="pr"{% else %} class="apr"{% endif %}{% endifnotequal %}{% endif %}{% endif %}{% endifnotequal %}{% else %} class="fp{% if post.numchild != 1 %} l{% endif %}{% if post.censor %}{% if not user.is_staff %} pc{% else %} apc{% endif %}{% else %}{% ifnotequal post.abuse 0 %}{% if not user.is_staff %} pr{% else %} apr{% endif %}{% endifnotequal %}{% endif %}"{% endif %}>
    {% if not post.is_flat %}{% ifnotequal post.depth listdepth %}{% if not post.next_sibling %}<div class="pp"></div>{% endif %}<div class="hw"><div class="pt e1"></div><div class="pt e2"></div>{% endifnotequal %}{% endif %}
      {% if post.censor and not user.is_staff %}
        <div id="pv{{ post.id_form_m }}" class="v"><div id="pt{{ post.id_form_m }}" class="t"><div>Censored post <a href="{% url snapboard_post post.id_form_m %}">#{{ post.id_form_m }}</a>.</div></div></div>
      {% else %}
        {% if not post.numanswers or post.nsib %}
          {% include "snapboard/include/post_full_header.html" %}
        {% else %}
          {% include "snapboard/include/post_short_header.html" %}
        {% endif %}
      {% endif %}
    {% if not post.is_flat %}{% ifnotequal post.depth listdepth %}</div>{% endifnotequal %}{% endif %}
    {% if post.is_flat %}<div id="{{ post.id_form_m }}_d">{% else %}{% ifequal post.depth listdepth %}<div id="{{ post.id_form_m }}_d">{% else %}<div class="pw" id="{{ post.id_form_m }}_d">{% endifequal %}{% endif %}
      {% if post.censor and not user.is_staff %}{% else %}
        {% if not post.numanswers or post.nsib %}
          {% include "snapboard/include/post_full_body.html" %}
        {% else %}
          {% include "snapboard/include/post_short_body.html" %}
        {% endif %}
      {% endif %}{# post.censor and not user.is_staff  else #}
  {% for close in post_info.close %}</div></div>{% endfor %}
{% endfor %}
</div>
<div class="ba">{% paginate %}</div>
</div>
